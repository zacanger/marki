"use strict";function Node(e){this.set_choice=function(e,t,n){return this.nodes[e]={node:t,data:n},this},this.get_choice=function(e){return this.nodes[e]},this.get_choice_node=function(e){var t=this.get_choice(e);return void 0===t?void 0:t.node},this.is_leaf=function(){return is_empty_object(this.nodes)},this.set_choices=function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];n instanceof Array?this.set_choice(t,n[0],n[1]):this.set_choice(t,n)}return this},this.data=e,this.nodes={}}function VIM(e){this.attach_to=function(e){this.m_selector=e,e.onkeydown=_proxy(this.on_keydown,this),e.onkeypress=_proxy(this.on_keypress,this),this.reset()},this.on_keydown=function(e){var t,n=__special_keys[e.keyCode];return t=void 0===n?!0:this.on_key("<"+n+">",e)},this.on_keypress=function(e){var t=String.fromCharCode(e.keyCode),n=this.on_key(t,e);return n},this.on_key=function(e,t){this.log('"'+e+'"');var n;return"<Escape>"===e?(this.reset(),n=!1):this.is_mode(INSERT)?"<Enter>"===e?(this.enter_auto_indent(),n=!1):n=!0:null!==e&&(this.accept_key(e),n=!1),!1===n&&(t.preventDefault(),t.stopPropagation()),n},this.enter_auto_indent=function(){var e=this.get_text(),t=this.get_pos(),n=select_line(e,t),i=count_space_from(e,n[0]),r=t-n[0];i=i>r?r:i;var s="\n"+repeat_str(" ",i);e=insert_at(e,s,t),this.set_text(e),this.set_pos(t+s.length)},this.set_mode=function(e){this.log("set_mode "+e),this.m_mode===COMMAND&&e===VISUAL&&(this.m_selection_from=this.get_pos()),this.m_mode=e,void 0!==this.on_set_mode&&this.on_set_mode(this)},this.insert_to_clipboard=function(e){this.log("insert_to_clipboard len: "+e.length),this.m_allow_clipboard_reset&&(this.m_allow_clipboard_reset=!1,this.m_buffer=""),this.m_buffer+=e},this.allow_clipboard_reset=function(e){this.m_allow_clipboard_reset=!0},this.get_clipboard=function(){return this.m_buffer},this.save_undo_state=function(){var e=this.get_text(),t=last(this.m_undo_stack);if(t=void 0===t?"":t.text,e!==t){var n={text:e,pos:this.get_pos()};this.m_undo_stack.push(n),this.m_undo_stack.length>UNDO_DEPTH&&this.m_undo_stack.shift(),this.log("undo depth "+this.m_undo_stack.length)}},this.is_mode=function(e){return this.m_mode===e},this.reset=function(){this.reset_mode(),this.reset_commands()},this.reset_mode=function(){this.set_mode(COMMAND)},this.reset_commands=function(){this.m_cnode=this.m_ctrees[this.m_mode],this.m_cdata={},this.m_current_sequence=""},this.get_pos=function(){return getCaret(document.activeElement)},this.get_text=function(){return this.m_selector.value},this.set_text=function(e){this.m_selector.value=e},this.set_pos=function(e){_select_pos(this.m_selector,e),void 0!==this.on_set_pos&&this.on_set_pos(this)},this.select_current_line=function(){return select_line(this.get_text(),this.get_pos())},this.accept_key=function(e){this.m_current_sequence+=e;var t=this.m_cnode.get_choice(e);if(void 0===t)this.log('(unknown sequence "'+this.m_current_sequence+'"'),this.reset_commands();else if(this.m_cdata=merge_dict(this.m_cdata,t.data),this.m_cdata=merge_dict(this.m_cdata,t.node.data),this.m_cnode=t.node,this.m_cnode.is_leaf()){var n;void 0===this.m_cdata.digit?(n=""===this.m_digit_buffer?1:parseInt(this.m_digit_buffer),n=n>NREPEATS_LIMIT?NREPEATS_LIMIT:1>n?1:n,this.m_digit_buffer=""):n=1,1!==n&&this.log("n. repeats: "+n),this.allow_clipboard_reset(),this.m_cdata.dont_save_undo_state||this.save_undo_state();for(var i=0;n>i;i++)this.execute_leaf();this.reset_commands()}},this.execute_leaf=function(){var e=this.m_cdata.action;void 0===e?this.log("ERROR: could not execute leaf!"):e(this,this.m_cdata)},this.log=function(e){void 0!==this.on_log&&this.on_log(e)},this.m_ctrees=build_sequence_trees(),this.m_selector=null,this.m_mode=void 0,this.m_selection_from=void 0,this.m_cnode=void 0,this.m_current_sequence="",this.m_digit_buffer="",this.m_cdata={},this.m_undo_stack=[],this.m_buffer="",this.on_set_mode=void 0,this.on_set_pos=void 0,this.on_log=void 0}function getCaret(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var n=e.createTextRange(),i=n.duplicate();return n.moveToBookmark(t.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0}angular.module("markvi",["ngAnimate","ngCookies","ngSanitize","ui.router","LocalStorageModule"]),angular.module("markvi").config(function(e,t,n,i){i.html5Mode({enabled:!1,requireBase:!1}),e.state("main",{url:"/",templateUrl:"/views/main.html",controller:"MainCtrl"}).state("file",{url:"/:id",templateUrl:"/views/main.html",controller:"MainCtrl"}).state("about",{url:"/about",templateUrl:"/views/about.html",controller:"AboutCtrl"}),t.otherwise("/")}).run(function(e){e.isMobileDevice=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase())}),function(){function e(e){this.tokens=[],this.tokens.links={},this.options=e||a.defaults,this.rules=l.normal,this.options.gfm&&(this.options.tables?this.rules=l.tables:this.rules=l.gfm)}function t(e,t){if(this.options=t||a.defaults,this.links=e,this.rules=u.normal,this.renderer=this.options.renderer||new n,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=u.breaks:this.rules=u.gfm:this.options.pedantic&&(this.rules=u.pedantic)}function n(e){this.options=e||{}}function i(e){this.tokens=[],this.token=null,this.options=e||a.defaults,this.options.renderer=this.options.renderer||new n,this.renderer=this.options.renderer,this.renderer.options=this.options}function r(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function s(e){return e.replace(/&([#\w]+);/g,function(e,t){return t=t.toLowerCase(),"colon"===t?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function o(e,t){return e=e.source,t=t||"",function n(i,r){return i?(r=r.source||r,r=r.replace(/(^|[^\[])\^/g,"$1"),e=e.replace(i,r),n):new RegExp(e,t)}}function c(){}function _(e){for(var t,n,i=1;i<arguments.length;i++){t=arguments[i];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}function a(t,n,s){if(s||"function"==typeof n){s||(s=n,n=null),n=_({},a.defaults,n||{});var o,c,l=n.highlight,u=0;try{o=e.lex(t,n)}catch(h){return s(h)}c=o.length;var d=function(e){if(e)return n.highlight=l,s(e);var t;try{t=i.parse(o,n)}catch(r){e=r}return n.highlight=l,e?s(e):s(null,t)};if(!l||l.length<3)return d();if(delete n.highlight,!c)return d();for(;u<o.length;u++)!function(e){return"code"!==e.type?--c||d():l(e.text,e.lang,function(t,n){return t?d(t):null==n||n===e.text?--c||d():(e.text=n,e.escaped=!0,void(--c||d()))})}(o[u])}else try{return n&&(n=_({},a.defaults,n)),i.parse(e.lex(t,n),n)}catch(h){if(h.message+="\nPlease report this to https://github.com/chjj/marked.",(n||a.defaults).silent)return"<p>An error occured:</p><pre>"+r(h.message+"",!0)+"</pre>";throw h}}var l={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:c,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:c,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:c,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};l.bullet=/(?:[*+-]|\d+\.)/,l.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,l.item=o(l.item,"gm")(/bull/g,l.bullet)(),l.list=o(l.list)(/bull/g,l.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+l.def.source+")")(),l.blockquote=o(l.blockquote)("def",l.def)(),l._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",l.html=o(l.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,l._tag)(),l.paragraph=o(l.paragraph)("hr",l.hr)("heading",l.heading)("lheading",l.lheading)("blockquote",l.blockquote)("tag","<"+l._tag)("def",l.def)(),l.normal=_({},l),l.gfm=_({},l.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),l.gfm.paragraph=o(l.paragraph)("(?!","(?!"+l.gfm.fences.source.replace("\\1","\\2")+"|"+l.list.source.replace("\\1","\\3")+"|")(),l.tables=_({},l.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),e.rules=l,e.lex=function(t,n){var i=new e(n);return i.lex(t)},e.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},e.prototype.token=function(e,t,n){for(var i,r,s,o,c,_,a,u,h,e=e.replace(/^ +$/gm,"");e;)if((s=this.rules.newline.exec(e))&&(e=e.substring(s[0].length),s[0].length>1&&this.tokens.push({type:"space"})),s=this.rules.code.exec(e))e=e.substring(s[0].length),s=s[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?s:s.replace(/\n+$/,"")});else if(s=this.rules.fences.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"code",lang:s[2],text:s[3]||""});else if(s=this.rules.heading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:s[1].length,text:s[2]});else if(t&&(s=this.rules.nptable.exec(e))){for(e=e.substring(s[0].length),_={type:"table",header:s[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3].replace(/\n$/,"").split("\n")},u=0;u<_.align.length;u++)/^ *-+: *$/.test(_.align[u])?_.align[u]="right":/^ *:-+: *$/.test(_.align[u])?_.align[u]="center":/^ *:-+ *$/.test(_.align[u])?_.align[u]="left":_.align[u]=null;for(u=0;u<_.cells.length;u++)_.cells[u]=_.cells[u].split(/ *\| */);this.tokens.push(_)}else if(s=this.rules.lheading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:"="===s[2]?1:2,text:s[1]});else if(s=this.rules.hr.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"hr"});else if(s=this.rules.blockquote.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"blockquote_start"}),s=s[0].replace(/^ *> ?/gm,""),this.token(s,t,!0),this.tokens.push({type:"blockquote_end"});else if(s=this.rules.list.exec(e)){for(e=e.substring(s[0].length),o=s[2],this.tokens.push({type:"list_start",ordered:o.length>1}),s=s[0].match(this.rules.item),i=!1,h=s.length,u=0;h>u;u++)_=s[u],a=_.length,_=_.replace(/^ *([*+-]|\d+\.) +/,""),~_.indexOf("\n ")&&(a-=_.length,_=this.options.pedantic?_.replace(/^ {1,4}/gm,""):_.replace(new RegExp("^ {1,"+a+"}","gm"),"")),this.options.smartLists&&u!==h-1&&(c=l.bullet.exec(s[u+1])[0],o===c||o.length>1&&c.length>1||(e=s.slice(u+1).join("\n")+e,u=h-1)),r=i||/\n\n(?!\s*$)/.test(_),u!==h-1&&(i="\n"===_.charAt(_.length-1),r||(r=i)),this.tokens.push({type:r?"loose_item_start":"list_item_start"}),this.token(_,!1,n),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(s=this.rules.html.exec(e))e=e.substring(s[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===s[1]||"script"===s[1]||"style"===s[1]),text:s[0]});else if(!n&&t&&(s=this.rules.def.exec(e)))e=e.substring(s[0].length),this.tokens.links[s[1].toLowerCase()]={href:s[2],title:s[3]};else if(t&&(s=this.rules.table.exec(e))){for(e=e.substring(s[0].length),_={type:"table",header:s[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3].replace(/(?: *\| *)?\n$/,"").split("\n")},u=0;u<_.align.length;u++)/^ *-+: *$/.test(_.align[u])?_.align[u]="right":/^ *:-+: *$/.test(_.align[u])?_.align[u]="center":/^ *:-+ *$/.test(_.align[u])?_.align[u]="left":_.align[u]=null;for(u=0;u<_.cells.length;u++)_.cells[u]=_.cells[u].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(_)}else if(t&&(s=this.rules.paragraph.exec(e)))e=e.substring(s[0].length),this.tokens.push({type:"paragraph",text:"\n"===s[1].charAt(s[1].length-1)?s[1].slice(0,-1):s[1]});else if(s=this.rules.text.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"text",text:s[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var u={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:c,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:c,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};u._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,u._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,u.link=o(u.link)("inside",u._inside)("href",u._href)(),u.reflink=o(u.reflink)("inside",u._inside)(),u.normal=_({},u),u.pedantic=_({},u.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),u.gfm=_({},u.normal,{escape:o(u.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:o(u.text)("]|","~]|")("|","|https?://|")()}),u.breaks=_({},u.gfm,{br:o(u.br)("{2,}","*")(),text:o(u.gfm.text)("{2,}","*")()}),t.rules=u,t.output=function(e,n,i){var r=new t(n,i);return r.output(e)},t.prototype.output=function(e){for(var t,n,i,s,o="";e;)if(s=this.rules.escape.exec(e))e=e.substring(s[0].length),o+=s[1];else if(s=this.rules.autolink.exec(e))e=e.substring(s[0].length),"@"===s[2]?(n=":"===s[1].charAt(6)?this.mangle(s[1].substring(7)):this.mangle(s[1]),i=this.mangle("mailto:")+n):(n=r(s[1]),i=n),o+=this.renderer.link(i,null,n);else if(this.inLink||!(s=this.rules.url.exec(e))){if(s=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(s[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(s[0])&&(this.inLink=!1),e=e.substring(s[0].length),o+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(s[0]):r(s[0]):s[0];else if(s=this.rules.link.exec(e))e=e.substring(s[0].length),this.inLink=!0,o+=this.outputLink(s,{href:s[2],title:s[3]}),this.inLink=!1;else if((s=this.rules.reflink.exec(e))||(s=this.rules.nolink.exec(e))){if(e=e.substring(s[0].length),t=(s[2]||s[1]).replace(/\s+/g," "),t=this.links[t.toLowerCase()],!t||!t.href){o+=s[0].charAt(0),e=s[0].substring(1)+e;continue}this.inLink=!0,o+=this.outputLink(s,t),this.inLink=!1}else if(s=this.rules.strong.exec(e))e=e.substring(s[0].length),o+=this.renderer.strong(this.output(s[2]||s[1]));else if(s=this.rules.em.exec(e))e=e.substring(s[0].length),o+=this.renderer.em(this.output(s[2]||s[1]));else if(s=this.rules.code.exec(e))e=e.substring(s[0].length),o+=this.renderer.codespan(r(s[2],!0));else if(s=this.rules.br.exec(e))e=e.substring(s[0].length),o+=this.renderer.br();else if(s=this.rules.del.exec(e))e=e.substring(s[0].length),o+=this.renderer.del(this.output(s[1]));else if(s=this.rules.text.exec(e))e=e.substring(s[0].length),o+=this.renderer.text(r(this.smartypants(s[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else e=e.substring(s[0].length),n=r(s[1]),i=n,o+=this.renderer.link(i,null,n);return o},t.prototype.outputLink=function(e,t){var n=r(t.href),i=t.title?r(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,i,this.output(e[1])):this.renderer.image(n,i,r(e[1]))},t.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},t.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",i=e.length,r=0;i>r;r++)t=e.charCodeAt(r),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},n.prototype.code=function(e,t,n){if(this.options.highlight){var i=this.options.highlight(e,t);null!=i&&i!==e&&(n=!0,e=i)}return t?'<pre><code class="'+this.options.langPrefix+r(t,!0)+'">'+(n?e:r(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:r(e,!0))+"\n</code></pre>"},n.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},n.prototype.html=function(e){return e},n.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},n.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},n.prototype.list=function(e,t){var n=t?"ol":"ul";return"<"+n+">\n"+e+"</"+n+">\n"},n.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},n.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},n.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},n.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},n.prototype.tablecell=function(e,t){var n=t.header?"th":"td",i=t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">";return i+e+"</"+n+">\n"},n.prototype.strong=function(e){return"<strong>"+e+"</strong>"},n.prototype.em=function(e){return"<em>"+e+"</em>"},n.prototype.codespan=function(e){return"<code>"+e+"</code>"},n.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},n.prototype.del=function(e){return"<del>"+e+"</del>"},n.prototype.link=function(e,t,n){if(this.options.sanitize){try{var i=decodeURIComponent(s(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(r){return""}if(0===i.indexOf("javascript:")||0===i.indexOf("vbscript:"))return""}var o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+n+"</a>"},n.prototype.image=function(e,t,n){var i='<img src="'+e+'" alt="'+n+'"';return t&&(i+=' title="'+t+'"'),i+=this.options.xhtml?"/>":">"},n.prototype.text=function(e){return e},i.parse=function(e,t,n){var r=new i(t,n);return r.parse(e)},i.prototype.parse=function(e){this.inline=new t(e.links,this.options,this.renderer),this.tokens=e.reverse();for(var n="";this.next();)n+=this.tok();return n},i.prototype.next=function(){return this.token=this.tokens.pop()},i.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},i.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},i.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,i,r,s="",o="";for(n="",e=0;e<this.token.header.length;e++)i={header:!0,align:this.token.align[e]},n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(s+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",r=0;r<t.length;r++)n+=this.renderer.tablecell(this.inline.output(t[r]),{header:!1,align:this.token.align[r]});o+=this.renderer.tablerow(n)}return this.renderer.table(s,o);case"blockquote_start":for(var o="";"blockquote_end"!==this.next().type;)o+=this.tok();return this.renderer.blockquote(o);case"list_start":for(var o="",c=this.token.ordered;"list_end"!==this.next().type;)o+=this.tok();return this.renderer.list(o,c);case"list_item_start":for(var o="";"list_item_end"!==this.next().type;)o+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(o);case"loose_item_start":for(var o="";"list_item_end"!==this.next().type;)o+=this.tok();return this.renderer.listitem(o);case"html":var _=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(_);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},c.exec=c,a.options=a.setOptions=function(e){return _(a.defaults,e),a},a.defaults={gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!0,headerPrefix:"",renderer:new n,xhtml:!1},a.Parser=i,a.parser=i.parse,a.Renderer=n,a.Lexer=e,a.lexer=e.lex,a.InlineLexer=t,a.inlineLexer=t.output,a.parse=a,"undefined"!=typeof module&&"object"==typeof exports?module.exports=a:"function"==typeof define&&define.amd?define(function(){return a}):this.marked=a}.call(function(){return this||("undefined"!=typeof window?window:global)}());var merge_dict=function(e,t){var n={},i=function(e){for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t])};return i(e),void 0!==t&&i(t),n},is_empty_object=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},COMMAND="COMMAND",INSERT="INSERT",VISUAL="VISUAL",NREPEATS_LIMIT=100,UNDO_DEPTH=100,_proxy=function(e,t){return function(){return e.apply(t,arguments)}},__special_keys={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Delete"},_select_pos=function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}},node=function(e){return new Node(e)},build_sequence_trees=function(){var e=build_tree_command_mode(),t=build_tree_visual_mode();return{COMMAND:e,VISUAL:t}},build_tree_command_mode=function(){var e=function(e){return function(t,n){var i=e(t,n);return 0===i[1]?i:[i[0]+1,i[1]-2]}},t=function(e){return function(t,n){var i=select_line(t,n),r=i[0],s=i[1],o=t.substr(r,s),c=e(o,n-r);return[c[0]+r,c[1]]}},n={a:node().set_choice("p",node({select_func:d_with_whitespaces_after(select_paragraph)})).set_choice("w",node({select_func:find_word_with_spaces_after})).set_choice("W",node({select_func:d_with_spaces_after(find_word_plus)})).set_choice("'",node({select_func:t(select_quotes.partial("'"))})).set_choice('"',node({select_func:t(select_quotes.partial('"'))})).set_choice("(",node({select_func:select_bounds.partial("()")})).set_choice(")",node({select_func:select_bounds.partial("()")})).set_choice("{",node({select_func:select_bounds.partial("{}")})).set_choice("}",node({select_func:select_bounds.partial("{}")})).set_choice("<",node({select_func:select_bounds.partial("<>")})).set_choice(">",node({select_func:select_bounds.partial("<>")})).set_choice("[",node({select_func:select_bounds.partial("[]")})).set_choice("]",node({select_func:select_bounds.partial("[]")})),i:node().set_choice("p",node({select_func:select_paragraph})).set_choice("w",node({select_func:find_word})).set_choice("W",node({select_func:find_word_plus})).set_choice("'",node({select_func:e(t(select_quotes.partial("'")))})).set_choice('"',node({select_func:e(t(select_quotes.partial('"')))})).set_choice("(",node({select_func:e(select_bounds.partial("()"))})).set_choice(")",node({select_func:e(select_bounds.partial("()"))})).set_choice("{",node({select_func:e(select_bounds.partial("{}"))})).set_choice("}",node({select_func:e(select_bounds.partial("{}"))})).set_choice("<",node({select_func:e(select_bounds.partial("<>"))})).set_choice(">",node({select_func:e(select_bounds.partial("<>"))})).set_choice("[",node({select_func:e(select_bounds.partial("[]"))})).set_choice("]",node({select_func:e(select_bounds.partial("[]"))}))},i=node({select_func:select_line}),r=node().set_choices(make_choices_for_navigation()).set_choices(n).set_choice("c",i).set_choice("w",node({select_func:till_right_word_bound})).set_choice("W",node({select_func:till_right_word_bound_plus})),s=make_node_dy("d").set_choices(n),o=make_node_dy("y").set_choices(n),c=make_node_indent(">").set_choices(n),_=make_node_indent("<").set_choices(n),a=node().set_choices(make_choices_for_navigation({action:act_move})).set_choices(make_choices_for_digits()).set_choice("a",node({action:act_append})).set_choice("A",node({action:act_append_to_end})).set_choice("c",r,{action:act_delete_range,mode:INSERT}).set_choice("C",node({action:act_delete_range,mode:INSERT,move_func:move_to_line_end})).set_choice("d",s,{action:act_delete_range,mode:COMMAND}).set_choice("D",node({action:act_delete_range,mode:COMMAND,move_func:move_to_line_end})).set_choice("i",node({action:act_insert})).set_choice("J",node({action:act_merge_lines})).set_choice("o",node({action:act_insert_line_after})).set_choice("O",node({action:act_insert_line_before})).set_choice("p",node({action:act_paste_after})).set_choice("P",node({action:act_paste_before})).set_choice("s",node({action:act_delete_char,mode:INSERT})).set_choice("u",node({action:act_undo,dont_save_undo_state:!0})).set_choice("v",node({action:act_visual_mode})).set_choice("x",node({action:act_delete_char})).set_choice("y",o,{action:act_yank_range}).set_choice(">",c,{action:act_indent_increase}).set_choice("<",_,{action:act_indent_decrease});return a},make_node_dy=function(e){var t=node().set_choices(make_choices_for_navigation()).set_choice(e,node({select_func:select_line_nl})).set_choice("w",node({select_func:till_next_word})).set_choice("W",node({select_func:till_next_word_plus}));return t},make_node_indent=function(e){var t=node().set_choices(make_choices_for_navigation()).set_choice(e,node({select_func:select_line}));return t},build_tree_visual_mode=function(){var e=node().set_choices(make_choices_for_navigation({action:act_move})).set_choices(make_choices_for_digits()).set_choice("d",node({action:act_delete_current_selection,mode:COMMAND})).set_choice("c",node({action:act_delete_current_selection,mode:INSERT}));return e},make_choices_for_navigation=function(e){e=void 0===e?{}:e;var t=function(t){return node(merge_dict(e,t))},n=node().set_choice("g",t({move_func:move_to_very_beginning})),i={0:t({move_func:move_to_line_start}),$:t({move_func:move_to_line_end}),"<Left>":t({move_func:move_left}),"<Down>":t({move_func:move_down}),"<Up>":t({move_func:move_up}),"<Right>":t({move_func:move_right}),h:t({move_func:move_left}),j:t({move_func:move_down}),k:t({move_func:move_up}),l:t({move_func:move_right}),"<Enter>":t({move_func:move_to_word_in_next_line}),"<Backspace>":t({move_func:move_left}),w:t({move_func:move_to_next_word}),W:t({move_func:move_to_next_word_plus}),e:t({move_func:move_to_end_of_word}),E:t({move_func:move_to_end_of_word_plus}),b:t({move_func:move_to_prev_word}),B:t({move_func:move_to_prev_word_plus}),g:n,G:t({move_func:move_to_very_end})};return i},make_choices_for_digits=function(){for(var e={},t=1;10>t;t++){var n=t.toString();e[n]=node({action:act_accept_digit,digit:n})}return e[0]=node({action:act_zero,digit:"0"}),e},find_word=function(e,t){var n="(\\s(?=\\S))|([^W](?=[W]))|(\\S(?=\\s))|([W](?=[^W]))".replace(/W/g,"\\u0000-\\u002f\\u003a-\\u0040\\u005b-\\u0060\\u007b-\\u00bf"),i=new RegExp(n,"g");return __find_regex_break(i,e,t)},find_word_plus=function(e,t){var n=/(\s(?=\S))|(\S(?=\s))/g;return __find_regex_break(n,e,t)},find_word_with_spaces_after=function(e,t){return d_with_spaces_after(find_word)(e,t)},d_with_spaces_after=function(e){return d_with_characters_after(e," ")},d_with_whitespaces_after=function(e){return d_with_characters_after(e,"\ns")},d_with_characters_after=function(e,t){return function(n,i){var r=e(n,i),s=count_space_from(n,r[0]+r[1],t);return[r[0],r[1]+s]}},find_word_plus_with_trailing_spaces=function(e,t){var n=find_word_plus(e,t),i=count_space_from(e,n[0]+n[1]);return[n[0],n[1]+i]},till_right_word_bound=function(e,t){var n=find_word(e,t);return[t,n[0]+n[1]-t]},till_right_word_bound_plus=function(e,t){var n=find_word_plus(e,t);return[t,n[0]+n[1]-t]},till_next_word=function(e,t){var n=find_word_with_spaces_after(e,t);return[t,n[0]+n[1]-t]},till_next_word_plus=function(e,t){var n=find_word_plus_with_trailing_spaces(e,t);return[t,n[0]+n[1]-t]},regex_end_pos=function(e,t,n){n=void 0===n?{from:0}:n;var i=t.substr(n.from),r=e.exec(i),s=0;return null===r?null:r.index+r[s].length+n.from},cut_slice=function(e,t,n){var i,r;return n>t?(i=t,r=n):(i=n,r=t),{text:e.substr(0,i)+e.substr(r),cut:e.substr(i,r-i),from:i,to:r}},select_line=function(e,t){var n=trailing_nl(e,t),i=leading_nl(e,t);return[n,i-n]},select_line_nl=function(e,t){var n=trailing_nl(e,t),i=leading_nl(e,t);return[n,i-n+1]},select_next_line=function(e,t){var n=select_line(e,t),i=n[0]+n[1]+1;return i<e.length?select_line(e,i):void 0},select_prev_line=function(e,t){var n=select_line(e,t),i=n[0]-1;return i>=0?select_line(e,i):void 0},select_bounds=function(e,t,n){var i,r,s=e.charAt(0),o=e.charAt(1);if(t.charAt(n)==s)i=n;else for(var c=1,_=n-1;_>=0;_--){var a=t.charAt(_);if(c+=(a===s?-1:0)+(a===o?1:0),0===c){i=_;break}}if(t.charAt(n)==o)r=n;else for(var c=1,_=n+1;_<t.length;_++){var a=t.charAt(_);if(c+=(a===s?1:0)+(a===o?-1:0),0===c){r=_;break}}return void 0===r||void 0===i?[n,0]:[i,r-i+1]},select_quotes=function(e,t,n){var i=__select_quotes(e,t,n),r=i[0],s=i[1];return void 0===r||void 0===s?[n,0]:[r,s-r+1]},__select_quotes=function(e,t,n){for(var i,r,s=n;s>=0;s--)if(t.substr(s,e.length)===e){i=s;break}for(var s=n+1;s<t.length;s++)if(t.substr(s,e.length)===e){r=s;break}return[i,r]},select_paragraph=function(e,t){var n=/\n\s*\n/g;return __find_regex(n,e,t)},__find_regex=function(e,t,n){for(var i,r,s=0;null!==(i=e.exec(t));){var o=i.index+i[0].length;(void 0===s||n>=o)&&(s=o),o=i.index,void 0===r&&o>n&&(r=o)}return r=void 0===r?t.length:r,[s,r-s]},__find_regex_break=function(e,t,n){for(var i,r,s=0;null!==(i=e.exec(t));){var o=i.index+1;(void 0===s||n>=o)&&(s=o),void 0===r&&o>n&&(r=o)}return r=void 0===r?t.length:r,[s,r-s]},trailing_nl=function(e,t){var n=trailing_char(e,t,"\n");return void 0===n?0:n},leading_nl=function(e,t){var n=leading_char(e,t,"\n");return void 0===n?e.length:n},trailing_char=function(e,t,n){for(var i,r=t-1;r>=0;r--)if(e.charAt(r)==n){i=r+1;break}return i},leading_char=function(e,t,n){for(var i,r=t;r<e.length;r++)if(e.charAt(r)==n){i=r;break}return i},skip_spaces=function(e){return function(t,n){var i=count_space_from(t,n),r=e(t,i+n);return r}},count_space_from=function(e,t,n){n=void 0===n?" ":n;var i=new RegExp("^["+n+"]+"),r=i.exec(e.substr(t));return null===r?0:r[0].length},count_space_to=function(e,t){var n;if(t>e.length)n=0;else{var i=/[ ]+$/.exec(e.substr(0,t));n=null===i?0:i[0].length}return n},insert_at=function(e,t,n){return e.slice(0,n).concat(t).concat(e.slice(n))},repeat_str=function(e,t){return new Array(t+1).join(e)},last=function(e,t){return e.length>0?e[e.length-1]:t},insert_line_after_auto_indent=function(e,t){var n=select_line(e,t),i=count_space_from(e,n[0]),r="\n"+repeat_str(" ",i),s={};return s.text=insert_at(e,r,n[0]+n[1]),s.pos=n[0]+n[1]+i+1,s};Function.prototype.partial=function(){var e=to_array(arguments),t=this;return function(){var n=to_array(arguments);return t.apply(this,e.concat(n))}};var to_array=function(e){return Array.prototype.slice.call(e,0)},act_insert_line_after=function(e,t){var n=e.get_text(),i=e.get_pos(),r=insert_line_after_auto_indent(n,i);e.set_text(r.text),e.set_pos(r.pos),e.set_mode(INSERT)},act_insert_line_before=function(e,t){var n=e.get_text(),i=e.get_pos(),r=select_line(n,i),s=count_space_from(n,r[0]),o=repeat_str(" ",s)+"\n";n=insert_at(n,o,r[0]),e.set_text(n),e.set_pos(r[0]+s),e.set_mode(INSERT)},act_move=function(e,t){var n=t.move_func.apply(e,[e.get_text(),e.get_pos()]);e.set_pos(n)},act_accept_digit=function(e,t){e.m_digit_buffer+=t.digit},act_zero=function(e,t){if(""===e.m_digit_buffer){var n=e.select_current_line();e.set_pos(n[0])}else e.m_digit_buffer+=t.digit},act_delete_range=function(e,t){e.log("delete range");var n=__yank(e,t);e.set_text(n.text),e.set_pos(n.from),e.set_mode(t.mode)},act_yank_range=function(e,t){e.log("yank range");var n=__yank(e,t);
e.set_pos(n.from)},__yank=function(e,t){var n=selection_with.apply(e,[t,e.get_text(),e.get_pos()]),i=cut_slice(e.get_text(),n[0],n[0]+n[1]);return e.insert_to_clipboard(i.cut),i},selection_with=function(e,t,n){var i,r;if(i=e.select_func,void 0===i){i=e.move_func;var s=i.apply(this,[t,n]),o=s-n;r=o>=0?[n,o]:[n+o,-o]}else r=i.apply(this,[t,n]);return r},act_delete_char=function(e,t){var n=e.get_pos(),i=e.get_text();e.set_text(i.substr(0,n)+i.substr(n+1)),e.set_pos(n),e.insert_to_clipboard(i.substr(n,1)),void 0!==t.mode&&e.set_mode(INSERT)},act_append=function(e,t){e.log("append");var n=e.select_current_line(),i=e.get_pos();e.set_pos(i+(i==n[0]+n[1]?0:1)),e.set_mode(INSERT)},act_append_to_end=function(e,t){e.log("append to end");var n=e.select_current_line();e.set_pos(n[0]+n[1]),e.set_mode(INSERT)},act_insert=function(e,t){e.log("insert"),e.set_mode(INSERT)},act_delete_current_selection=function(e,t){e.log("delete current selection");var n=cut_slice(e.get_text(),e.m_selection_from,e.get_pos());e.set_text(n.text),e.set_pos(n.from),e.set_mode(t.mode),e.insert_to_clipboard(n.cut)},act_visual_mode=function(e,t){e.log("act_visual_mode"),e.set_mode(VISUAL)},act_undo=function(e,t){if(e.m_undo_stack.length>0){e.log("act_undo");var n=e.m_undo_stack.pop();e.set_text(n.text),e.set_pos(n.pos)}},act_paste_after=function(e,t){var n=e.get_pos();__paste(e,t),e.set_pos(n+e.get_clipboard().length)},act_paste_before=function(e,t){var n=e.get_pos();__paste(e,t),e.set_pos(n)},__paste=function(e,t){var n=e.get_pos(),i=e.get_clipboard(),r=e.get_text();e.log("act_paste, length: "+i.length),e.set_text(r.substr(0,n)+i+r.substr(n))},act_merge_lines=function(e,t){e.log("act_merge_lines");var n=e.get_pos(),i=e.get_text(),r=select_line(i,n),s=r[0]+r[1];i=i.substr(0,s)+i.substr(s+1),e.set_text(i),e.set_pos(s)},act_indent_increase=function(e,t){e.log("act_indent_increase"),__alter_selection(e,t,function(e){return e.replace(/^/gm," ")})},act_indent_decrease=function(e,t){e.log("act_indent_decrease"),__alter_selection(e,t,function(e){return e.replace(/^ /gm,"")})},__alter_selection=function(e,t,n){var i=selection_with.apply(e,[t,e.get_text(),e.get_pos()]);i=expand_to_line_start(e.get_text(),i);var r=cut_with(e.get_text(),i);r.mid=n(r.mid);var s=r.left+r.mid+r.right;e.set_text(s),e.set_pos(i[0]+count_space_from(s,i[0]))},expand_to_line_start=function(e,t){var n=select_line(e,t[0]),i=t[0]-n[0];return[n[0],t[1]+i]},cut_with=function(e,t){var n=t[0],i=t[1];return{left:e.substr(0,n),mid:e.substr(n,i),right:e.substr(n+i)}},move_right=function(e,t){return t<e.length?t+1:t},move_left=function(e,t){return t>0?t-1:t},move_down=function(e,t){var n=select_next_line(e,t);if(void 0!==n){var i=select_line(e,t),r=t-i[0];r=r>=n[1]?n[1]:r,t=r+n[0]}return t},move_up=function(e,t){var n=select_prev_line(e,t);if(void 0!==n){var i=select_line(e,t),r=t-i[0];r=r>=n[1]?n[1]:r,t=r+n[0]}return t},move_to_next_word=function(e,t){var n=find_word_with_spaces_after(e,t);return n[0]+n[1]},move_to_next_word_plus=function(e,t){var n=find_word_plus_with_trailing_spaces(e,t);return n[0]+n[1]},move_to_end_of_word=function(e,t){var n=skip_spaces(find_word)(e,t);return n[0]+n[1]},move_to_end_of_word_plus=function(e,t){var n=skip_spaces(find_word_plus)(e,t);return n[0]+n[1]},move_to_prev_word=function(e,t){var n=count_space_to(e,t)+1,i=find_word(e,t-n);return i[0]},move_to_prev_word_plus=function(e,t){var n=count_space_to(e,t)+1,i=find_word_plus(e,t-n);return i[0]},move_to_word_in_next_line=function(e,t){var n,i=select_next_line(e,t);if(void 0===i)n=t;else{var r=count_space_from(e,i[0]);n=i[0]+r}return n},move_to_very_beginning=function(e,t){return 0},move_to_very_end=function(e,t){return e.length},move_to_line_start=function(e,t){var n=select_line(e,t);return n[0]},move_to_line_end=function(e,t){var n=select_line(e,t);return n[0]+n[1]};